-- Most liked poster on tag, likes from much liked posters count for more
--	- Tag (Linear to number of posts)

select ps_creatorid, sum (likeauth.auth) as sc
from post, tag, post_tag, likes l,
     (select ps_creatorid as liker, count (*) as auth
     from post, likes where ps_postid = l_postid
     group by ps_creatorid) likeauth
where liker = l_personid and l_postid = ps_postid 
      and pst_postid = ps_postid 
      and   pst_tagid = t_tagid and t_name = '--1--'
group by ps_creatorid
order by sc desc, ps_creatorid asc
limit 100;

